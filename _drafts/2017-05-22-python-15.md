---
layout: post
title: 重点工作内容总结
categories: [Python]
description: 15 questions about Python.
keywords: Python
---

#### OpenStack服务的全流程无损重启

##### 目标
线上服务需要保证持续的可用性和可靠性，但这与功能的频繁迭代更新又是矛盾的。在每次做线上服务升级时均需要重新启动服务使新功能生效，而重启服务又会导致服务的中断和不可用。为了在重启服务时也能保证不影响线上正在进行的业务不受影响，我们引入了服务的全流程无损重启功能。

##### 功能划分
全流程无损重启整体分为三大块：
1）服务被中断后的重新拉起执行。
2）nova-api服务的可重入，调用方需要增加重试机制。
3）我们服务调用第三方接口的可重入，以及失败后的重试机制。

##### 服务中断后的重新拉起执行
这部分是无损重启的核心功能。每一个请求在刚进入到某个服务处理时，都会记录一条request请求信息在数据库表requests中，状态为"start"。包括请求ID、进入的服务名称、完成该请求的回调方法、调用该方法的请求参数和上下文、请求状态、请求时间等等。一旦请求在该服务的处理阶段服务被重启，执行被中断，即请求状态仍然为"start"，未被置为"end"。则在服务重新启动后，扫描requests表中有没有在该服务处理阶段，未完成处理，即请求状态为"start"的记录。如果有，则重置主机状态为进入该服务时的初始状态，使用表记录中的请求参数调用回调方法完成这次请求未完成的操作。

其中，在记录回调函数的请求参数和上下文的过程中有一些技术难点。序列化和反序列化时，有些类实例中的内容是不可序列化的。如果类实例中包含了其他的类的实例，或者其他不可序列化的成员，该对象也就无法序列化了和反序列化了。

##### 序列化与反序列化
使用inspect遍历序列化对象的所有属性，遇到其他类型的类对象递归处理。

##### 

#### 调度模块优化
##### 性能优化
##### 减少线上资源碎片率的优化
##### 针对 KMR/RDS/REDIS 等 PAAS产品的定制化

#### 流控系统

#### OpenStack服务集群并发能力优化

#### Glance多线程带本地缓存下载

#### basic机房nova-compute服务重启时虚拟机不断网

#### 容灾分组

#### 专属物理机集群

#### 整体架构（从机房基础网络架构，到服务部署的架构，各个部分使用的技术等）

#### OpenStack做为分布式资源管理系统，是如何从较差的性能和稳定性，一步步改进到高效可靠的

#### 如何与产品经理沟通产品需求

#### 如何带新人快速融入

#### 如何将产品需求转化为设计方案，以及如何按照设计方案划分功能模块

#### Python编程语言本身